/*! Copyright(c) 2021 https://github.com/ping

This software is released under the Reciprocal Public License 1.5.
https://opensource.org/licenses/RPL-1.5

*/
!function(){var e=window.matchMedia("(prefers-color-scheme: dark)").matches,a='&copy; <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a target="_blank" href="https://carto.com/attributions">CARTO</a>',t=L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{attribution:a,subdomains:"abcd",maxZoom:19,detectRetina:!1}),o=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:a,subdomains:"abcd",maxZoom:19,detectRetina:!1}),r=function(e){var a=e.getChildCount(),t=" marker-cluster-";return t+=a<10?"small":a<100?"medium":"large",a>=1e3&&(a=(a/1e3).toPrecision(2)+"k"),a>=1e5&&(a=(a/1e3).toPrecision(3)+"k"),new L.DivIcon({html:"<div><span>"+a+"</span></div>",className:"marker-cluster"+t,iconSize:new L.Point(40,40)})},l=L.markerClusterGroup({iconCreateFunction:r}),i=L.markerClusterGroup({iconCreateFunction:r}),n=L.markerClusterGroup({iconCreateFunction:r}),s=L.markerClusterGroup({iconCreateFunction:r}),c=L.map("map",{minZoom:2,tap:!1,zoomControl:!1}).on("load",(function(){fetch("libraries_branches.geojson").then((e=>e.json())).then((e=>{var a=document.getElementById("marker-template").innerHTML;["small","medium","large"].forEach((t=>{var o={type:"FeatureCollection"};"all"===t?o=e:o.features=e.features.filter((e=>e.properties["marker-size"]===t));var r="#eeeeee",c="circle";switch(t){case"large":r="#f73bbf",c="circle";break;case"medium":r="#3bf1f7",c="penta";break;case"small":r="#f7f73b",c="square"}var d=L.ExtraMarkers.icon({icon:"fa-circle",prefix:"fa",svg:!0,markerColor:r,shape:c,iconColor:"#33333366",extraClasses:"od-marker-icon-"+t,className:"od-marker-"+t}),m=L.geoJson(o,{pointToLayer:function(e,a){return L.marker(a,{icon:d})},onEachFeature:function(e,t){var o=Mustache.render(a,e);t.bindPopup(o)}});switch(l.addLayer(m),t){case"large":i.addLayer(m);break;case"medium":n.addLayer(m);break;case"small":s.addLayer(m)}})),c.addLayer(l);var t={'<i class="fa fa-building fa-lg lib-all" aria-hidden="true"></i>':l,'<i class="fa fa-building-o lib-small" aria-hidden="true"></i>':s,'<i class="fa fa-building-o fa-lg lib-medium" aria-hidden="true"></i>':n,'<i class="fa fa-building-o fa-2x lib-large" aria-hidden="true"></i>':i};L.control.layers(t,{},{collapsed:!1,position:"topright"}).addTo(c),document.getElementsByClassName("lib-all")[0].parentElement.title="All libraries",document.getElementsByClassName("lib-small")[0].parentElement.title="Small libraries (collection<50k)",document.getElementsByClassName("lib-medium")[0].parentElement.title="Medium libraries (50k≤collection<100k)",document.getElementsByClassName("lib-large")[0].parentElement.title="Large libraries (collection≥100k)"}))})),d=function(){const a=localStorage.getItem("theme");null===a&&e||"dark"===a?(document.body.classList.add("dark-mode"),c.removeLayer(o),c.addLayer(t)):(document.body.classList.remove("dark-mode"),c.removeLayer(t),c.addLayer(o))};d(),L.Control.themeToggle=L.Control.extend({onAdd:function(a){const t=L.DomUtil.create("a");return t.id="theme-toggle",t.title="Toggle theme",t.classList.add("leaflet-bar"),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 118a22 22 0 01-22-22V48a22 22 0 0144 0v48a22 22 0 01-22 22zM256 486a22 22 0 01-22-22v-48a22 22 0 0144 0v48a22 22 0 01-22 22zM369.14 164.86a22 22 0 01-15.56-37.55l33.94-33.94a22 22 0 0131.11 31.11l-33.94 33.94a21.93 21.93 0 01-15.55 6.44zM108.92 425.08a22 22 0 01-15.55-37.56l33.94-33.94a22 22 0 1131.11 31.11l-33.94 33.94a21.94 21.94 0 01-15.56 6.45zM464 278h-48a22 22 0 010-44h48a22 22 0 010 44zM96 278H48a22 22 0 010-44h48a22 22 0 010 44zM403.08 425.08a21.94 21.94 0 01-15.56-6.45l-33.94-33.94a22 22 0 0131.11-31.11l33.94 33.94a22 22 0 01-15.55 37.56zM142.86 164.86a21.89 21.89 0 01-15.55-6.44l-33.94-33.94a22 22 0 0131.11-31.11l33.94 33.94a22 22 0 01-15.56 37.55zM256 358a102 102 0 11102-102 102.12 102.12 0 01-102 102z"/></svg>',t.addEventListener("click",(function(){let a=localStorage.getItem("theme");a=null===a&&e||"dark"===a?"light":"dark",localStorage.setItem("theme",a),d()})),t}}),L.control.themeToggle=function(e){return new L.Control.themeToggle(e)},L.control.themeToggle({position:"topright"}).addTo(c),L.control.locate({position:"topleft",flyTo:!1,keepCurrentZoomLevel:!0,initialZoomLevel:12}).addTo(c),L.control.zoom({position:"topright"}).addTo(c);var m=L.Control.geocoder({position:"topleft",collapsed:!1,placeholder:"Search by Location",defaultMarkGeocode:!1}).on("markgeocode",(function(e){c.fitBounds(e.geocode.bbox)})).addTo(c);L.DomEvent.addListener(m._input,"focus",(()=>{m._input.placeholder="Press enter/return to search"})),L.DomEvent.addListener(m._input,"dblclick",(()=>{m._input.value=""})),L.DomEvent.addListener(m._input,"blur",(()=>{m._input.placeholder="Search by Location",L.DomUtil.removeClass(m._errorElement,"leaflet-control-geocoder-error"),L.DomUtil.addClass(m._alts,"leaflet-control-geocoder-alternatives-minimized")})),L.Control.footer=L.Control.extend({onAdd:function(e){const a=L.DomUtil.create("div");return a.id="footer",a.innerHTML='<a href="https://github.com/ping/overdrive-libraries/blob/master/libraries.csv"><i class="fa fa-github" aria-hidden="true"></i></a> Not affiliated to, endorsed or certified by OverDrive. <a target="_blank" href="https://www.overdrive.com/libraries">Find a library <i class="fa fa-external-link" aria-hidden="true"></i ></a >',a}}),L.control.footer=function(e){return new L.Control.footer(e)},L.control.footer({position:"bottomleft"}).addTo(c),c.setView([23.56399,0],2),c.setMaxBounds([[82.76537263027352,244.68750000000003],[-73.12494524712693,-244.68750000000003]])}();